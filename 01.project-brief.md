# 01.project-brief.md

## 1. Overview

Cinselhobi.com Next, WooCommerce tabanlı mevcut e-ticaret sitesinden veri çekerek PostgreSQL veritabanına aktaran ve Next.js App Router ile modern bir frontend arayüzü sunan full-stack e-ticaret uygulamasıdır. Proje, native mobile app hissi veren dokunsal ve akıcı bir kullanıcı deneyimi hedefler.

**Evidence:** `README.md` (lines 1-5), `package.json` (name: "cinselhobi-com-next"), `docs/01-frontend-project-doc-v1.md` (lines 1-16)

---

## 2. Goals

- WooCommerce REST API'den ürün ve kategori verilerini tek seferlik import ederek PostgreSQL'e aktarmak
- Next.js App Router ile modern, performanslı bir e-ticaret storefront oluşturmak
- Native mobile app hissi veren responsive UI/UX tasarımı
- Kamatera VPS üzerinde self-hosted deployment
- Drizzle ORM ile type-safe veritabanı sorguları
- NextAuth.js (Auth.js v5) ile kullanıcı kimlik doğrulama
- Sepet, favoriler, sipariş yönetimi gibi temel e-ticaret özellikleri

**Evidence:** `docs/01-frontend-project-doc-v1.md` (lines 1-35), `README.md` (lines 109-181), `package.json` (scripts: woo:import)

---

## 3. Non-Goals

- Prisma ORM kullanımı (Drizzle tercih ediliyor)
- VPS dışı yönetilen platform kullanımı (self-hosted yaklaşım)
- "Her şeyi bir anda" özellik ekleme (önce iskelet + veri + temel UI)
- Test framework kurulumu (şu an test dosyası yok)

**Evidence:** `docs/01-frontend-project-doc-v1.md` (lines 29-34), `package.json` (devDependencies: test framework yok)

---

## 4. Primary User Flows

### 4.1 Ürün Keşfi
- Ana sayfa: Kategoriler grid'i + Yeni ürünler listesi
- Kategori sayfası: Filtreleme (fiyat, stok durumu, alt kategoriler) + Sıralama + Cursor-based pagination
- Ürün detay: Galeri, açıklama, fiyat, sepete ekleme
- Arama: Gerçek zamanlı arama overlay, ürün ve kategori sonuçları

**Evidence:** `src/app/page.tsx`, `src/app/categories/page.tsx`, `src/app/urun/[slug]/page.tsx`, `src/app/search/page.tsx`, `src/components/search/search-overlay.tsx`

### 4.2 Kullanıcı İşlemleri
- Kayıt/Giriş: Email + şifre ile credentials authentication
- Hesap yönetimi: Adresler, siparişler, kuponlar, ayarlar, favoriler
- Sepet: Ürün ekleme, miktar güncelleme, checkout akışı
- Sipariş: Sipariş oluşturma, durum takibi, başarı sayfası

**Evidence:** `src/app/login/page.tsx`, `src/app/signup/page.tsx`, `src/app/account/`, `src/app/cart/page.tsx`, `src/app/checkout/page.tsx`, `src/app/order-success/[id]/page.tsx`

### 4.3 Admin İşlemleri
- Sipariş yönetimi: Sipariş listesi, detay görüntüleme, durum güncelleme

**Evidence:** `src/app/admin/orders/`, `src/components/admin/order-status-form.tsx`

---

## 5. Tech Stack

### 5.1 Framework & Runtime
- **Next.js:** 16.1.1 (App Router)
- **React:** 19.2.3
- **TypeScript:** 5.x
- **Node.js:** LTS 18+ (assumption)

**Evidence:** `package.json` (dependencies: next@16.1.1, react@19.2.3, react-dom@19.2.3), `tsconfig.json`

### 5.2 UI & Styling
- **Tailwind CSS:** v4 (PostCSS plugin ile)
- **shadcn/ui:** New York style, Radix UI primitives
- **Framer Motion:** 12.23.26 (animasyonlar)
- **Lucide React:** 0.562.0 (ikonlar)
- **next-themes:** 0.4.6 (dark mode)
- **Sonner:** 2.0.7 (toast notifications)

**Evidence:** `package.json` (dependencies), `components.json`, `tailwind.config.ts`, `postcss.config.mjs`, `src/app/globals.css`

### 5.3 State & Data
- **Drizzle ORM:** 0.45.1 (PostgreSQL)
- **PostgreSQL:** 16 (Docker)
- **pg:** 8.16.3 (PostgreSQL driver)
- **React Context API:** Cart, Favorites, Search, Auth, Theme providers

**Evidence:** `package.json` (dependencies: drizzle-orm, pg), `docker-compose.yml`, `src/db/schema.ts`, `src/components/cart/cart-provider.tsx`

### 5.4 Forms & Validation
- **React Hook Form:** 7.69.0
- **Zod:** 4.2.1
- **@hookform/resolvers:** 5.2.2

**Evidence:** `package.json` (dependencies), `src/components/auth/login-form.tsx`

### 5.5 Authentication
- **NextAuth.js (Auth.js v5):** 5.0.0-beta.25
- **@auth/drizzle-adapter:** 1.11.1
- **Argon2:** 0.44.0 (şifre hash)

**Evidence:** `package.json` (dependencies), `src/auth.ts`, `src/auth.config.ts`

### 5.6 Build & Dev Tools
- **ESLint:** 9 (Next.js config)
- **tsx:** 4.21.0 (script execution)
- **drizzle-kit:** 0.31.8 (migration tooling)
- **dotenv:** 17.2.3 (env management)

**Evidence:** `package.json` (devDependencies), `eslint.config.mjs`

---

## 6. Project Structure

```
/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── [slug]/             # Dynamic category/page route
│   │   ├── account/            # User account pages
│   │   ├── admin/              # Admin pages
│   │   ├── api/                # Route handlers
│   │   │   ├── auth/           # NextAuth endpoints
│   │   │   ├── products/       # Product API
│   │   │   └── search/        # Search API
│   │   ├── cart/               # Cart page
│   │   ├── categories/         # Category listing
│   │   ├── checkout/           # Checkout flow
│   │   ├── login/              # Login page
│   │   ├── signup/             # Signup page
│   │   ├── search/             # Search results
│   │   ├── urun/[slug]/        # Product detail
│   │   └── ...                 # Legal/content pages
│   ├── components/
│   │   ├── account/            # Account components
│   │   ├── admin/              # Admin components
│   │   ├── app/                # App-level (Footer, mobile nav)
│   │   ├── auth/               # Auth forms
│   │   ├── cart/               # Cart components
│   │   ├── catalog/            # Product catalog
│   │   ├── favorites/          # Wishlist
│   │   ├── layout/             # Header, navigation
│   │   ├── product/            # Product detail
│   │   ├── search/             # Search UI
│   │   ├── theme/              # Theme toggle
│   │   └── ui/                 # shadcn/ui components
│   ├── db/
│   │   ├── connection.ts       # Drizzle DB instance
│   │   ├── queries/           # Query functions
│   │   └── schema.ts          # Drizzle schema
│   ├── lib/
│   │   ├── format.ts          # Price/image formatting
│   │   ├── search/            # Search utilities
│   │   └── utils.ts           # cn() helper
│   ├── actions/                # Server actions
│   ├── config/                 # App config
│   ├── hooks/                  # React hooks
│   └── types/                  # TypeScript types
├── scripts/
│   └── woo-import.ts           # WooCommerce import script
├── drizzle/                    # Migration files
├── data/snapshots/             # Import snapshots
├── docs/                       # Documentation
└── docker-compose.yml          # PostgreSQL container
```

**Evidence:** `src/app/` (directory structure), `src/components/` (directory structure), `src/db/schema.ts`, `scripts/woo-import.ts`

---

## 7. Environments & Scripts

### 7.1 Package Manager
- **npm** (package-lock.json mevcut)

**Evidence:** `package-lock.json` (file exists)

### 7.2 Scripts
- `dev`: Development server (TZ=Europe/Istanbul)
- `build`: Production build (TZ=Europe/Istanbul)
- `start`: Production server (TZ=Europe/Istanbul)
- `lint`: ESLint check
- `db:generate`: Drizzle migration generate
- `db:migrate`: Drizzle migration apply
- `woo:import`: WooCommerce import script (tsx)

**Evidence:** `package.json` (scripts section)

### 7.3 Environment Variables
`.env.local` veya `.env` dosyaları kullanılıyor (dotenv ile yükleniyor). Dosya isimleri:
- `.env.local` (öncelikli)
- `.env` (fallback)

**Evidence:** `drizzle.config.ts` (lines 4-5), `src/db/connection.ts` (lines 6-7), `scripts/woo-import.ts` (dotenv.config calls)

**Not:** Secret değerler dokümante edilmedi. Sadece dosya isimleri listelendi.

---

## 8. APIs & Integrations (Frontend Perspective)

### 8.1 Internal API Routes
- `/api/products`: Ürün listesi (cursor-based pagination, filtreleme, sıralama)
- `/api/products/[slug]`: Ürün detay
- `/api/products/[slug]/related`: İlgili ürünler
- `/api/search`: Arama (ürün + kategori)
- `/api/auth/[...nextauth]`: NextAuth.js endpoints
- `/api/auth/signup`: Kullanıcı kayıt

**Evidence:** `src/app/api/products/route.ts`, `src/app/api/search/route.ts`, `src/app/api/auth/[...nextauth]/route.ts`

### 8.2 External Integrations
- **WooCommerce REST API:** Import script tarafından kullanılıyor (frontend'den direkt kullanılmıyor)
  - Base URL: `WOO_BASE_URL` env
  - Auth: `WOO_CONSUMER_KEY`, `WOO_CONSUMER_SECRET` env
  - Mode: `WOO_AUTH_MODE` (basic/query)

**Evidence:** `scripts/woo-import.ts` (lines 14-16, 88-138), `README.md` (lines 127-168)

### 8.3 Environment Keys (Frontend)
- `DATABASE_URL`: PostgreSQL connection string
- `AUTH_SECRET`: NextAuth.js secret
- `AUTH_URL`: NextAuth.js base URL (production)
- `WOO_BASE_URL`: WooCommerce site URL (import script)
- `WOO_CONSUMER_KEY`: WooCommerce API key (import script)
- `WOO_CONSUMER_SECRET`: WooCommerce API secret (import script)
- `WOO_IMPORT_MODE`: Import mode (full/sample)
- `WOO_IMPORT_LIMIT`: Sample mode limit
- `WOO_AUTH_MODE`: WooCommerce auth mode (basic/query)
- `WOO_PRODUCT_STATUS`: Product status filter (default: publish)

**Evidence:** `drizzle.config.ts`, `src/auth.ts` (line 17), `scripts/woo-import.ts` (lines 14-20), `README.md` (lines 72-84)

### 8.4 Data Fetching
- Server Components: Direct DB queries (Drizzle)
- Client Components: Fetch API ile `/api/*` routes
- Server Actions: `src/actions/` klasöründe (checkout, favorites, address, admin)

**Evidence:** `src/app/page.tsx` (Server Component), `src/components/catalog/load-more-grid.tsx` (fetch usage), `src/actions/`

---

## 9. Quality & Standards

### 9.1 Code Quality
- **ESLint:** Next.js core-web-vitals + TypeScript config
- **TypeScript:** Strict mode enabled
- **Linting:** `npm run lint` script mevcut

**Evidence:** `eslint.config.mjs`, `tsconfig.json` (strict: true), `package.json` (lint script)

### 9.2 Testing
- Test framework kurulu değil
- Test dosyası yok (`**/*test*`, `**/*spec*` araması sonuçsuz)

**Evidence:** No test files found in codebase search

### 9.3 Accessibility
- Radix UI primitives kullanımı (a11y built-in)
- Semantic HTML yapısı (assumption, layout.tsx'te görülebilir)

**Evidence:** `package.json` (@radix-ui/* packages), `src/app/layout.tsx` (semantic HTML structure)

### 9.4 Performance
- Cursor-based pagination (infinite scroll)
- Image optimization: Next.js Image component (remotePatterns config)
- Server Components: Default rendering strategy

**Evidence:** `next.config.ts` (images.remotePatterns), `src/app/api/products/route.ts` (cursor pagination), `src/app/page.tsx` (Server Component)

### 9.5 Error Handling
- Route handlers'da try-catch blokları
- Error boundaries: `not-found.tsx` mevcut

**Evidence:** `src/app/api/search/route.ts` (try-catch), `src/app/not-found.tsx`

---

## 10. Current Status

### 10.1 Local Development
- ✅ Development server çalışıyor (`npm run dev`)
- ✅ PostgreSQL Docker container ile local setup
- ✅ Drizzle migrations çalışıyor
- ✅ WooCommerce import script çalışıyor (sample/full mode)

**Evidence:** `README.md` (lines 9-60), `docker-compose.yml`, `package.json` (scripts)

### 10.2 Architecture
- ✅ App Router yapısı kurulu
- ✅ Component katmanı organize edilmiş
- ✅ Database schema tanımlı (Drizzle)
- ✅ Auth sistemi kurulu (NextAuth.js v5)
- ✅ Theme sistemi (dark/light mode)
- ✅ Mobile-first responsive design

**Evidence:** `src/app/` (route structure), `src/components/` (component organization), `src/db/schema.ts`, `src/auth.ts`, `src/components/theme/`

### 10.3 Component Maturity
- **Assumption:** Component library (shadcn/ui) kullanılıyor, temel UI bileşenleri mevcut
- Component sayısı: ~50+ (ui/, catalog/, product/, cart/, vb.)
- Storybook yok

**Evidence:** `src/components/ui/` (15 files), `components.json` (shadcn config), No storybook config found

---

## 11. Known Gaps / Risks

### 11.1 Testing
- Test framework kurulu değil
- Unit test yok
- E2E test yok
- Integration test yok

**Evidence:** No test files found

### 11.2 Environment Configuration
- `.env*` dosyaları gitignore'da (secret management belirsiz)
- Production environment variables dokümante edilmemiş

**Evidence:** `.env*` files not found in repo (expected, gitignored)

### 11.3 Error Handling
- Global error boundary yok (sadece not-found.tsx var)
- API error responses standardize edilmemiş (assumption)

**Evidence:** `src/app/not-found.tsx` exists, no `error.tsx` found in root app/

### 11.4 Performance Monitoring
- Analytics entegrasyonu yok (assumption)
- Performance monitoring yok (assumption)

**Evidence:** No analytics/performance monitoring code found

### 11.5 Documentation
- API endpoint'leri dokümante edilmemiş
- Component API'leri dokümante edilmemiş
- Deployment process dokümante edilmiş (`docs/04-deploy-kamatera-pm2.md`)

**Evidence:** `docs/` directory exists, API docs not found

---

## 12. Open Questions

1. Production deployment süreci tam olarak nasıl? (PM2 config, build optimizations)
2. CDN kullanılıyor mu? (Image optimization için)
3. Payment gateway entegrasyonu hangi aşamada? (Checkout sayfası var ama payment processing belirsiz)
4. Email service entegrasyonu var mı? (Order confirmations, password reset)
5. SEO stratejisi nedir? (Metadata, sitemap, robots.txt)
6. Analytics tool entegrasyonu planlanıyor mu? (Google Analytics, vb.)
7. Error logging/monitoring service kullanılıyor mu? (Sentry, LogRocket, vb.)
8. Backup stratejisi nedir? (Database backups, snapshot management)
9. Multi-language support planlanıyor mu? (i18n)
10. Admin panel'de başka özellikler planlanıyor mu? (Product management, user management)

---

## 13. Evidence Index

1. **Package.json:** `package.json` - Dependencies, scripts, project name
2. **README:** `README.md` - Setup instructions, WooCommerce import guide
3. **Next.js Config:** `next.config.ts` - Image optimization, timezone
4. **TypeScript Config:** `tsconfig.json` - Compiler options, paths
5. **Drizzle Config:** `drizzle.config.ts` - Database connection, schema path
6. **Database Schema:** `src/db/schema.ts` - Tables: products, categories, users, orders, etc.
7. **Auth Setup:** `src/auth.ts` - NextAuth.js configuration, credentials provider
8. **App Router Structure:** `src/app/` - Route organization, page components
9. **Component Library:** `components.json` - shadcn/ui configuration
10. **Tailwind Config:** `tailwind.config.ts` - Content paths, theme extensions
11. **PostCSS Config:** `postcss.config.mjs` - Tailwind v4 plugin
12. **Docker Compose:** `docker-compose.yml` - PostgreSQL 16 container
13. **WooCommerce Import:** `scripts/woo-import.ts` - Import script implementation
14. **API Routes:** `src/app/api/products/route.ts`, `src/app/api/search/route.ts` - Internal APIs
15. **Global Styles:** `src/app/globals.css` - CSS variables, theme tokens
16. **Root Layout:** `src/app/layout.tsx` - Providers, theme, structure
17. **Home Page:** `src/app/page.tsx` - Server Component, data fetching
18. **ESLint Config:** `eslint.config.mjs` - Linting rules
19. **Project Docs:** `docs/01-frontend-project-doc-v1.md` - Project goals, tech stack
20. **WooCommerce Docs:** `docs/03-woo-import-guide.md` - Import process documentation

