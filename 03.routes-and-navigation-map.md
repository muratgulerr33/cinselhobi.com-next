# 03. Routes and Navigation Map

Bu doküman, Cinselhobi.com Next projesinin route yapısını, navigasyon haritasını ve sayfa organizasyonunu tanımlar. Amaç: AI asistanların (Cursor/Gemini) route kırmasını, yanlış link vermesini ve flow kaçırmasını engellemek.

**Son Güncelleme:** 2025-01-27  
**Proje:** cinselhobi-com-next  
**Next.js:** 16.1.1

---

## 1. Routing Overview

Next.js App Router kullanılıyor. Tüm route'lar `src/app/` altında tanımlı. `pages/` klasörü yok.

**Route Kategorileri:**
- **Public Routes:** Ana sayfa, ürünler, kategoriler, arama, içerik sayfaları, sepet
- **Protected Routes:** Hesap yönetimi (`/account/*`), Admin panel (`/admin/*`)
- **Conditional/Session-dependent Routes:** Checkout (`/checkout`), Sipariş başarı (`/order-success/[id]`) - sayfa seviyesinde auth kontrolü yok ama işlevsellik için session gerekli
- **API Routes:** `/api/*` altında route handler'lar

**Dynamic Routes:**
- `[slug]` - Kategori sayfaları için (`/[slug]/page.tsx`)
- `[slug]` - Ürün detay sayfaları için (`/urun/[slug]/page.tsx`)
- `[id]` - Sipariş detay sayfaları için (`/order-success/[id]/page.tsx`, `/account/orders/[id]/page.tsx`, `/admin/orders/[id]/page.tsx`)

**Route Groups:** Kullanılmıyor (kanıt: `src/app/` yapısında `(group)` pattern'i yok)

**Evidence:** `src/app/` directory structure, `package.json` (next@16.1.1)

---

## 2. Route Table (Pages)

| Route | File Path | Type | Dynamic? | Rendering | Data Source | Auth | Notes |
|-------|-----------|------|----------|-----------|-------------|------|-------|
| `/` | `src/app/page.tsx` | Page | - | Server Component | Direct DB (Drizzle: `getTopCategories`, `getLatestProductsCursor`) | Public | Ana sayfa, kategori grid + yeni ürünler (kanıt: lines 1, 11, 14) |
| `/[slug]` | `src/app/[slug]/page.tsx` | Page | `slug` (category) | Server Component | Direct DB (Drizzle: `getCategoryBySlug`, `getProductsCursor`, `db`, `categories`, `drizzle-orm`) | Public | Kategori sayfası, RESERVED_SLUGS kontrolü var (kanıt: lines 2-8, 13-15, 22-36, 47) |
| `/urun/[slug]` | `src/app/urun/[slug]/page.tsx` | Page | `slug` (product) | Server Component | Direct DB (Drizzle: `getProductBySlug`) | Public | Ürün detay sayfası, `generateMetadata` var, `notFound()` kullanıyor (kanıt: line 3) |
| `/search` | `src/app/search/page.tsx` | Page | - | Server Component | Direct DB (Drizzle: `db`, `products`, `categories`, `productCategories`, `drizzle-orm`) | Public | Arama sonuçları, `searchParams.q` kullanıyor, Suspense var (kanıt: lines 3-5, 17-36) |
| `/categories` | `src/app/categories/page.tsx` | Page | - | Unknown | Unknown | Public | Kategori listesi sayfası |
| `/cart` | `src/app/cart/page.tsx` | Page | - | Server Component | Unknown | Public | Sepet sayfası |
| `/checkout` | `src/app/checkout/page.tsx` | Page | - | Client Component | Server Action (`getAddressesAction`) | Conditional | Checkout sayfası, boş sepet kontrolü var, `getAddressesAction` auth gerektirir (kanıt: `src/actions/address.ts` lines 51-54), `router.push` kullanıyor |
| `/order-success/[id]` | `src/app/order-success/[id]/page.tsx` | Page | `id` (order) | Server Component | Direct DB (`getOrderById`) | Conditional | Sipariş başarı sayfası, `auth()` kontrolü var, session yoksa `/login` redirect (kanıt: lines 14-18) |
| `/login` | `src/app/login/page.tsx` | Page | - | Unknown | Unknown | Public | Giriş sayfası |
| `/signup` | `src/app/signup/page.tsx` | Page | - | Unknown | Unknown | Public | Kayıt sayfası |
| `/account` | `src/app/account/page.tsx` | Page | - | Unknown | Unknown | Protected | Hesap ana sayfası, layout'ta auth kontrolü var |
| `/account/orders` | `src/app/account/orders/page.tsx` | Page | - | Unknown | Unknown | Protected | Sipariş listesi |
| `/account/orders/[id]` | `src/app/account/orders/[id]/page.tsx` | Page | `id` (order) | Unknown | Unknown | Protected | Sipariş detay |
| `/account/wishlist` | `src/app/account/wishlist/page.tsx` | Page | - | Unknown | Unknown | Protected | Favoriler sayfası |
| `/account/coupons` | `src/app/account/coupons/page.tsx` | Page | - | Unknown | Unknown | Protected | Kuponlar sayfası |
| `/account/addresses` | `src/app/account/addresses/page.tsx` | Page | - | Unknown | Unknown | Protected | Adresler sayfası |
| `/account/settings` | `src/app/account/settings/page.tsx` | Page | - | Unknown | Unknown | Protected | Hesap ayarları |
| `/admin` | `src/app/admin/page.tsx` | Page | - | Unknown | Unknown | Protected (admin role) | Admin dashboard |
| `/admin/orders` | `src/app/admin/orders/page.tsx` | Page | - | Unknown | Unknown | Protected (admin role) | Admin sipariş listesi |
| `/admin/orders/[id]` | `src/app/admin/orders/[id]/page.tsx` | Page | `id` (order) | Unknown | Unknown | Protected (admin role) | Admin sipariş detay |
| `/about` | `src/app/about/page.tsx` | Page | - | Unknown | Unknown | Public | Hakkımızda |
| `/support` | `src/app/support/page.tsx` | Page | - | Unknown | Unknown | Public | Destek sayfası |
| `/gizlilik-ve-guvenlik` | `src/app/gizlilik-ve-guvenlik/page.tsx` | Page | - | Unknown | Unknown | Public | Gizlilik politikası |
| `/odeme-ve-teslimat` | `src/app/odeme-ve-teslimat/page.tsx` | Page | - | Unknown | Unknown | Public | Ödeme ve teslimat bilgileri |
| `/cayma-ve-iade-kosullari` | `src/app/cayma-ve-iade-kosullari/page.tsx` | Page | - | Unknown | Unknown | Public | Cayma ve iade koşulları |
| `/mesafeli-satis-sozlesmesi` | `src/app/mesafeli-satis-sozlesmesi/page.tsx` | Page | - | Unknown | Unknown | Public | Mesafeli satış sözleşmesi |
| `/styleguide` | `src/app/styleguide/page.tsx` | Page | - | Client Component | Static | Public | Style guide (dev-only route, production'da kapatılmalı/korunmalı riski var) |

**Evidence:** `src/app/` directory structure, `src/app/page.tsx` (lines 1, 11, 14: `getTopCategories`, `getLatestProductsCursor`), `src/app/[slug]/page.tsx` (lines 2-8, 13-15: `getCategoryBySlug`, `getProductsCursor`, `db`, `drizzle-orm`), `src/app/urun/[slug]/page.tsx` (line 3: `getProductBySlug`), `src/app/search/page.tsx` (lines 3-5, 17-36: `db`, `products`, `categories`, `drizzle-orm`), `src/app/checkout/page.tsx`, `src/app/order-success/[id]/page.tsx` (lines 14-18: auth kontrolü), `src/app/account/layout.tsx`, `src/app/admin/layout.tsx`

---

## 3. Route Table (API / Route Handlers)

| Endpoint | File Path | Methods | Dynamic? | Caching/Dynamic | Notes |
|----------|-----------|---------|----------|----------------|-------|
| `/api/products` | `src/app/api/products/route.ts` | GET | - | `dynamic = "force-dynamic"`, `revalidate = 0`, `Cache-Control: no-store` | Cursor-based pagination, filtreleme (categorySlug, sort, min, max, inStock, sub), limit 1-50 clamp |
| `/api/products/[slug]` | `src/app/api/products/[slug]/route.ts` | GET | `slug` (product) | `dynamic = "force-dynamic"` | Ürün detay API, 404 döner ürün yoksa |
| `/api/products/[slug]/related` | `src/app/api/products/[slug]/related/route.ts` | GET | `slug` (product) | `dynamic = "force-dynamic"` | İlgili ürünler API, 10 ürün döner |
| `/api/search` | `src/app/api/search/route.ts` | GET | - | Unknown | Arama API, `q` query param, limit max 20, try-catch error handling |
| `/api/auth/[...nextauth]` | `src/app/api/auth/[...nextauth]/route.ts` | GET, POST | `...nextauth` (catch-all) | `runtime = "nodejs"` | NextAuth.js v5 endpoints |
| `/api/auth/signup` | `src/app/api/auth/signup/route.ts` | POST | - | `runtime = "nodejs"` | Kullanıcı kayıt API, Argon2 hash, try-catch error handling |

**Evidence:** `src/app/api/products/route.ts`, `src/app/api/products/[slug]/route.ts`, `src/app/api/products/[slug]/related/route.ts`, `src/app/api/search/route.ts`, `src/app/api/auth/[...nextauth]/route.ts`, `src/app/api/auth/signup/route.ts`

---

## 4. Layouts & Route Groups Map

### 4.1 Root Layout
- **File:** `src/app/layout.tsx`
- **Type:** Server Component (default)
- **Provider Hierarchy:** (sıra önemli)
  1. `ThemeProvider` (next-themes)
  2. `AuthProvider`
  3. `FavoritesProvider`
  4. `CartProvider`
  5. `HeaderProvider`
  6. `SearchProvider`
- **Components:** `Header`, `DesktopHeader`, `SearchOverlay`, `Footer` (xl+), `MobileBottomNav`, `Toaster` (Sonner)
- **Metadata:** `title: "Cinselhobi"`, `description: "Cinselhobi - Hobi ve El Sanatları"`

**Evidence:** `src/app/layout.tsx` (lines 59-87)

### 4.2 Account Layout
- **File:** `src/app/account/layout.tsx`
- **Type:** Server Component (async)
- **Auth Protection:** `auth()` kontrolü, session yoksa `/login?callbackUrl=/account` redirect
- **Components:** `AccountSidebar` (xl+), `AccountMobileNav` (xl-)
- **Structure:** Grid layout (xl: `[280px_1fr]`)

**Evidence:** `src/app/account/layout.tsx` (lines 11-12)

### 4.3 Admin Layout
- **File:** `src/app/admin/layout.tsx`
- **Type:** Server Component (async)
- **Auth Protection:** `auth()` kontrolü, session yoksa `/login?callbackUrl=/admin` redirect, `role !== "admin"` ise `/account` redirect
- **Components:** `AdminSidebar`
- **Structure:** Flex layout (sidebar + main)

**Evidence:** `src/app/admin/layout.tsx` (lines 7-11)

### 4.4 Route Groups
Route groups (`(group)`) kullanılmıyor. Tüm route'lar doğrudan `src/app/` altında.

**Evidence:** `src/app/` directory structure

---

## 5. Navigation Entry Points

### 5.1 Desktop Navigation
- **Component:** `src/components/layout/DesktopNavigation.tsx`
- **Type:** Client Component
- **Links:**
  - Kategoriler (mega menu dropdown): `/kadinlara-ozel`, `/erkeklere-ozel`, `/sex-oyuncaklari`, `/kozmetik`, `/geciktiriciler`, `/kayganlastirici-jeller`, `/anal-oyuncaklar`, `/realistik-mankenler` + alt kategoriler
  - Düz linkler: `/kadinlara-ozel`, `/erkeklere-ozel`, `/geciktiriciler`
- **Category Tree:** Hardcoded `categoryTree` array (lines 19-64)

**Evidence:** `src/components/layout/DesktopNavigation.tsx` (lines 19-64, 94, 118, 129, 146, 155, 164)

### 5.2 Footer Navigation
- **Component:** `src/components/app/Footer.tsx`
- **Type:** Client Component
- **Link Groups:**
  - **Kurumsal:** `/about`, `/support`, `/gizlilik-ve-guvenlik`, `/mesafeli-satis-sozlesmesi`
  - **Müşteri Hizmetleri:** `/support`, `/odeme-ve-teslimat`, `/cayma-ve-iade-kosullari`, `/sss` (route yok, link var)
  - **Kategoriler:** `/kadinlara-ozel`, `/erkeklere-ozel`, `/vibratorler`, `/kayganlastiricilar`, `/geciktiriciler`
- **Bottom Bar:** `/gizlilik-ve-guvenlik`, `/mesafeli-satis-sozlesmesi`, `/`

**Evidence:** `src/components/app/Footer.tsx` (lines 45-74, 322-341)

### 5.3 Mobile Bottom Navigation
- **Component:** `src/components/app/mobile-bottom-nav.tsx`
- **Type:** Client Component
- **Tabs:** (orderIndex sırasıyla)
  1. **home** (`/`) - Anasayfa
  2. **categories** (`/categories`) - Kategoriler (match: category route, `/urun/*`, `/search`, `/categories`)
  3. **cart** (null) - Sepet (drawer açılır, route push yok)
  4. **wishlist** (`/account/wishlist`) - Favoriler
  5. **profile** (`/account`) - Hesabım (match: `/account/*` except `/account/wishlist`)
- **Special:** `/urun/[slug]` sayfalarında bottom nav gizlenir (line 48)

**Evidence:** `src/components/app/mobile-bottom-nav.tsx` (lines 48-50), `src/components/app/mobile-tabs.ts` (lines 39-82)

### 5.4 Account Sidebar Navigation
- **Component:** `src/components/account/AccountSidebar.tsx`
- **Type:** Client Component
- **Links:**
  - `/account/orders` - Siparişlerim
  - `/account/wishlist` - Favorilerim
  - `/account/coupons` - Kuponlarım
  - `/account/addresses` - Adreslerim
  - `/account/settings` - Hesap Ayarları

**Evidence:** `src/components/account/AccountSidebar.tsx` (lines 6-12)

### 5.5 Admin Sidebar Navigation
- **Component:** `src/components/admin/admin-sidebar.tsx`
- **Type:** Client Component
- **Links:**
  - `/admin` - Dashboard
  - `/admin/orders` - Siparişler
  - `/admin/products` - Ürünler (disabled)
  - `/` - Mağazaya Dön

**Evidence:** `src/components/admin/admin-sidebar.tsx` (lines 8-30)

### 5.6 Header Navigation
- **Component:** `src/components/layout/header.tsx`
- **Type:** Client Component
- **Features:** Search overlay trigger, cart icon, theme toggle, user menu
- **Reserved Slugs:** `RESERVED_SLUGS` array (lines 13-35) - bu slug'lar kategori route'u olarak işlenmez

**Evidence:** `src/components/layout/header.tsx` (lines 13-35)

---

## 6. Primary User Flows (Route-backed)

### 6.1 Home → Category → Product → Cart → Checkout → Success
**Route Flow:**
1. `/` - Ana sayfa (kategori grid + yeni ürünler)
2. `/[slug]` - Kategori sayfası (filtreleme, sıralama, pagination)
3. `/urun/[slug]` - Ürün detay sayfası
4. `/cart` - Sepet sayfası (veya mobile drawer)
5. `/checkout` - Checkout sayfası (adres seçimi, ödeme yöntemi)
6. `/order-success/[id]` - Sipariş başarı sayfası

**Critical UI States:**
- `/urun/[slug]`: `loading.tsx` var, `notFound()` kullanıyor
- `/[slug]`: `loading.tsx` var, `notFound()` kullanıyor
- `/checkout`: Boş sepet kontrolü var, `/cart` redirect
- `/cart`: Sepet boşsa gösterim (assumption)

**Evidence:** `src/app/page.tsx`, `src/app/[slug]/page.tsx`, `src/app/urun/[slug]/page.tsx`, `src/app/cart/page.tsx`, `src/app/checkout/page.tsx` (lines 100-111), `src/app/order-success/[id]/page.tsx`

### 6.2 Search Flow
**Route Flow:**
1. Header search trigger → Search overlay açılır
2. `/search?q=...` - Arama sonuçları sayfası

**Critical UI States:**
- `/search`: Suspense var, `searchParams.q` kontrolü var, boş query durumu handle ediliyor

**Evidence:** `src/app/search/page.tsx` (lines 142-166), `src/components/search/search-overlay.tsx`

### 6.3 Account Management Flow
**Route Flow:**
1. `/login` veya `/signup` - Giriş/Kayıt
2. `/account` - Hesap ana sayfası (auth redirect: `/login?callbackUrl=/account`)
3. `/account/orders` - Sipariş listesi
4. `/account/orders/[id]` - Sipariş detay
5. `/account/wishlist` - Favoriler
6. `/account/addresses` - Adresler
7. `/account/settings` - Ayarlar

**Critical UI States:**
- `/account/*`: Layout'ta auth kontrolü var, session yoksa redirect

**Evidence:** `src/app/account/layout.tsx` (lines 11-12), `src/app/login/page.tsx`, `src/app/signup/page.tsx`

### 6.4 Admin Flow
**Route Flow:**
1. `/admin` - Admin dashboard (auth + role kontrolü: `/login?callbackUrl=/admin`, role !== "admin" → `/account`)
2. `/admin/orders` - Sipariş listesi
3. `/admin/orders/[id]` - Sipariş detay

**Critical UI States:**
- `/admin/*`: Layout'ta auth + role kontrolü var

**Evidence:** `src/app/admin/layout.tsx` (lines 7-11)

---

## 7. Auth & Access Rules

### 7.1 Protected Routes
- **`/account/*`**: `src/app/account/layout.tsx` içinde `auth()` kontrolü, session yoksa `/login?callbackUrl=/account` redirect
- **`/admin/*`**: `src/app/admin/layout.tsx` içinde `auth()` kontrolü, session yoksa `/login?callbackUrl=/admin` redirect, `role !== "admin"` ise `/account` redirect

**Evidence:** `src/app/account/layout.tsx` (lines 11-12), `src/app/admin/layout.tsx` (lines 7-11)

### 7.2 Public Routes
- Tüm diğer route'lar public (kanıt: layout'larda auth kontrolü yok)

**Evidence:** `src/app/layout.tsx` (auth kontrolü yok)

### 7.3 Conditional/Session-dependent Routes
- **`/checkout`**: Sayfa seviyesinde auth kontrolü yok, ancak `getAddressesAction` Server Action'ı auth gerektirir. Session yoksa adresler yüklenemez ama sayfa render edilir.
- **`/order-success/[id]`**: Sayfa seviyesinde `auth()` kontrolü var, session yoksa `/login` redirect. Sipariş kullanıcıya ait değilse `/account` redirect.

**Evidence:** `src/app/checkout/page.tsx` (line 39: `getAddressesAction`), `src/actions/address.ts` (lines 51-54: auth kontrolü), `src/app/order-success/[id]/page.tsx` (lines 14-18, 21-25)

### 7.4 Login/Account Areas
- `/login` - Giriş sayfası
- `/signup` - Kayıt sayfası
- `/account/*` - Hesap yönetimi (protected)

**Evidence:** `src/app/login/page.tsx`, `src/app/signup/page.tsx`, `src/app/account/`

### 7.5 Redirect Behavior
- Checkout'ta sepet boşsa: `/cart` redirect (kanıt: `src/app/checkout/page.tsx` line 66)
- Account'a giriş yapmadan erişim: `/login?callbackUrl=/account` redirect
- Admin'e giriş yapmadan erişim: `/login?callbackUrl=/admin` redirect
- Admin'e admin olmayan kullanıcı erişimi: `/account` redirect

**Evidence:** `src/app/checkout/page.tsx` (line 66), `src/app/account/layout.tsx` (line 12), `src/app/admin/layout.tsx` (lines 8, 11)

---

## 8. Search Params & Dynamic Params

### 8.1 Dynamic Route Params

**`[slug]` (Category Route):**
- **Route:** `/[slug]/page.tsx`
- **Type:** `string`
- **Usage:** Kategori slug'ı, `getCategoryBySlug(slug)` ile kategori çekiliyor
- **Validation:** `RESERVED_SLUGS` kontrolü var, reserved ise `notFound()`, kategori yoksa `notFound()`
- **Rule:** Yeni top-level sayfa açılırsa slug `RESERVED_SLUGS` array'ine eklenmeli (kanıt: `src/app/[slug]/page.tsx` lines 22-36, `src/components/layout/header.tsx` lines 13-35, `src/components/app/mobile-tabs.ts` lines 2-17)

**Evidence:** `src/app/[slug]/page.tsx` (lines 22-36, 38-51), `src/components/layout/header.tsx` (lines 13-35), `src/components/app/mobile-tabs.ts` (lines 2-17)

**`[slug]` (Product Route):**
- **Route:** `/urun/[slug]/page.tsx`
- **Type:** `string`
- **Usage:** Ürün slug'ı, `getProductBySlug(slug)` ile ürün çekiliyor
- **Validation:** Ürün yoksa `notFound()`

**Evidence:** `src/app/urun/[slug]/page.tsx` (lines 72-79)

**`[id]` (Order Routes):**
- **Routes:** `/order-success/[id]/page.tsx`, `/account/orders/[id]/page.tsx`, `/admin/orders/[id]/page.tsx`
- **Type:** `string` (assumption)
- **Usage:** Sipariş ID'si

**Evidence:** `src/app/order-success/[id]/page.tsx`, `src/app/account/orders/[id]/page.tsx`, `src/app/admin/orders/[id]/page.tsx`

### 8.2 Search Params

**`/search?q=...`:**
- **Param:** `q` (string)
- **Usage:** Arama sorgusu, `searchParams.q` ile alınıyor
- **Validation:** Boş/trim edilmiş query kontrolü var

**Evidence:** `src/app/search/page.tsx` (lines 12, 143-144)

**`/[slug]?sort=...&min=...&max=...&inStock=...&sub=...`:**
- **Params:**
  - `sort`: `"newest" | "price_asc" | "price_desc" | "name_asc"` (default: "newest")
  - `min`: Fiyat minimum (TL, kuruşa çevriliyor)
  - `max`: Fiyat maksimum (TL, kuruşa çevriliyor)
  - `inStock`: `"1" | "true"` (boolean)
  - `sub`: Alt kategori wcId'leri (virgülle ayrılmış string)
  - `subCategoryIds`: Eski parametre (geriye dönük uyumluluk, internal ID'ler)
- **Usage:** Kategori sayfasında filtreleme ve sıralama

**Evidence:** `src/app/[slug]/page.tsx` (lines 19, 54-122)

**`/api/products?limit=...&cursor=...&categorySlug=...&sort=...&min=...&max=...&inStock=...&sub=...`:**
- **Params:**
  - `limit`: 1-50 arası (clamp ediliyor, default: `PRODUCTS_PER_PAGE`)
  - `cursor`: Cursor-based pagination cursor (number)
  - `categorySlug`: Kategori slug'ı
  - `sort`: `"newest" | "price_asc" | "price_desc" | "name_asc"` (default: "newest")
  - `min`: Fiyat minimum (TL, kuruşa çevriliyor)
  - `max`: Fiyat maksimum (TL, kuruşa çevriliyor)
  - `inStock`: `"1" | "true"` (boolean)
  - `sub`: Alt kategori wcId'leri (virgülle ayrılmış string)
  - `subCategoryIds`: Eski parametre (geriye dönük uyumluluk)
- **Usage:** API endpoint'inde filtreleme ve pagination

**Evidence:** `src/app/api/products/route.ts` (lines 16-103)

**`/api/search?q=...&limit=...`:**
- **Params:**
  - `q`: Arama sorgusu (required, boşsa boş array döner)
  - `limit`: Max 20 (default: 8)
- **Usage:** Arama API endpoint'i

**Evidence:** `src/app/api/search/route.ts` (lines 9-11, 22)

### 8.3 Param Contract
- **Category slug pattern:** Kebab-case, Türkçe karakterler destekleniyor (assumption: DB'de slug'lar var)
- **Product slug pattern:** Kebab-case, Türkçe karakterler destekleniyor (assumption: DB'de slug'lar var)
- **Order ID pattern:** Unknown (nanoid kullanılıyor mu? assumption: string)

**Evidence:** `src/app/[slug]/page.tsx`, `src/app/urun/[slug]/page.tsx`, `src/app/api/auth/signup/route.ts` (line 39: nanoid kullanılıyor)

---

## 9. Error/Loading/Not-Found Coverage

### 9.1 Loading States
- **`/[slug]/loading.tsx`** - Kategori sayfası için loading state
- **`/urun/[slug]/loading.tsx`** - Ürün detay sayfası için loading state
- **`/search`** - Suspense kullanılıyor (fallback: "Aranıyor...")

**Evidence:** `src/app/[slug]/loading.tsx`, `src/app/urun/[slug]/loading.tsx`, `src/app/search/page.tsx` (lines 154-162)

### 9.2 Error States
- **Root `error.tsx`:** Yok (kanıt: codebase search sonuçsuz)
- **Segment-level `error.tsx`:** Yok (kanıt: codebase search sonuçsuz)
- **API Error Handling:** Try-catch blokları kullanılıyor (`/api/search/route.ts`, `/api/auth/signup/route.ts`)

**Evidence:** Codebase search (error.tsx bulunamadı), `src/app/api/search/route.ts` (lines 98-106), `src/app/api/auth/signup/route.ts` (lines 51-57)

### 9.3 Not-Found States
- **Root `not-found.tsx`:** Var (`src/app/not-found.tsx`), Suspense ile wrap edilmiş
- **Segment-level `not-found.tsx`:** Yok (kanıt: codebase search sonuçsuz)
- **`notFound()` calls:**
  - `/[slug]/page.tsx`: Reserved slug veya kategori yoksa (lines 43-45, 49-51)
  - `/urun/[slug]/page.tsx`: Ürün yoksa (line 78)

**Evidence:** `src/app/not-found.tsx`, `src/app/[slug]/page.tsx` (lines 43-45, 49-51), `src/app/urun/[slug]/page.tsx` (line 78)

### 9.4 Gaps
- Root `error.tsx` yok (global error boundary yok)
- Segment-level `error.tsx` yok
- Segment-level `not-found.tsx` yok (sadece root var)
- **Broken Navigation Link:** Footer'da `/sss` linki var ama route yok (`src/components/app/Footer.tsx` line 61) - 404 riski

**Evidence:** Codebase search (error.tsx, segment-level not-found.tsx bulunamadı), `src/components/app/Footer.tsx` (line 61: `/sss` linki), `src/app/` (sss route yok)

---

## 10. SEO & Metadata Notes

### 10.1 Metadata Exports
- **Root Layout:** `metadata` export var (`title: "Cinselhobi"`, `description: "Cinselhobi - Hobi ve El Sanatları"`)
- **Product Detail:** `generateMetadata` export var (`/urun/[slug]/page.tsx`), dynamic metadata (title, description, openGraph images)

**Evidence:** `src/app/layout.tsx` (lines 32-35), `src/app/urun/[slug]/page.tsx` (lines 44-69)

### 10.2 SEO Features
- **Open Graph:** Product detail sayfasında `openGraph` metadata var
- **Canonical URLs:** Unknown (kanıt: codebase search sonuçsuz)
- **Robots:** Unknown (kanıt: `robots.txt` dosyası yok)
- **Sitemap:** Unknown (kanıt: `sitemap.xml` dosyası yok)

**Evidence:** `src/app/urun/[slug]/page.tsx` (lines 63-67), Codebase search (canonical, robots.txt, sitemap.xml bulunamadı)

---

## 11. Open Questions

1. `/categories` sayfası ne gösteriyor? (component içeriği unknown)
2. `/cart` sayfası rendering type nedir? (Client/Server Component unknown)
3. `/order-success/[id]` sayfası ne gösteriyor? (component içeriği unknown)
4. `/login` ve `/signup` sayfaları rendering type nedir? (Client/Server Component unknown)
5. Account sayfaları (`/account/*`) rendering type nedir? (Client/Server Component unknown)
6. Admin sayfaları (`/admin/*`) rendering type nedir? (Client/Server Component unknown)
7. İçerik sayfaları (`/about`, `/support`, vb.) rendering type nedir? (Client/Server Component unknown)
8. Canonical URL'ler kullanılıyor mu?
9. Robots.txt ve sitemap.xml var mı?
10. Middleware kullanılıyor mu? (kanıt: `middleware.ts` dosyası yok)

---

## 12. Evidence Index

1. **src/app/** - App Router directory structure (`src/app/`)
2. **src/app/page.tsx** - Ana sayfa, Server Component, direct DB queries: `getTopCategories`, `getLatestProductsCursor` (lines 1, 11, 14)
3. **src/app/[slug]/page.tsx** - Kategori sayfası, Server Component, RESERVED_SLUGS kontrolü, direct DB: `getCategoryBySlug`, `getProductsCursor`, `db`, `drizzle-orm` (lines 2-8, 13-15, 22-36, 38-51)
4. **src/app/urun/[slug]/page.tsx** - Ürün detay, Server Component, generateMetadata, notFound(), direct DB: `getProductBySlug` (lines 3, 44-69, 72-79)
5. **src/app/search/page.tsx** - Arama sayfası, Server Component, Suspense, searchParams.q, direct DB: `db`, `products`, `categories`, `drizzle-orm` (lines 3-5, 12, 17-36, 142-166)
6. **src/app/checkout/page.tsx** - Checkout, Client Component, router.push, boş sepet kontrolü, `getAddressesAction` (auth gerektirir) (lines 25, 39, 66, 84)
7. **src/app/order-success/[id]/page.tsx** - Sipariş başarı, Server Component, auth kontrolü, direct DB: `getOrderById` (lines 4-6, 14-18, 21-25)
8. **src/app/cart/page.tsx** - Sepet sayfası, Server Component (line 1-5)
9. **src/app/styleguide/page.tsx** - Styleguide, Client Component, dev-only route (line 1, 37)
10. **src/app/layout.tsx** - Root layout, provider hierarchy, metadata (lines 32-35, 59-87)
11. **src/app/account/layout.tsx** - Account layout, auth protection, redirect (lines 11-12)
12. **src/app/admin/layout.tsx** - Admin layout, auth + role protection, redirect (lines 7-11)
13. **src/app/not-found.tsx** - Root not-found, Suspense (lines 24-28)
14. **src/app/[slug]/loading.tsx** - Kategori loading state
15. **src/app/urun/[slug]/loading.tsx** - Ürün loading state
16. **src/actions/address.ts** - `getAddressesAction` auth kontrolü (lines 51-54)
13. **src/app/api/products/route.ts** - Products API, cursor pagination, filtreleme (lines 9-10, 16-103, 148)
14. **src/app/api/products/[slug]/route.ts** - Product detail API, dynamic route (lines 4, 39-73)
15. **src/app/api/products/[slug]/related/route.ts** - Related products API (lines 4, 39-67)
16. **src/app/api/search/route.ts** - Search API, query param, error handling (lines 8-11, 98-106)
17. **src/app/api/auth/[...nextauth]/route.ts** - NextAuth endpoints (lines 3, 5)
18. **src/app/api/auth/signup/route.ts** - Signup API, error handling (lines 8, 51-57)
19. **src/components/layout/DesktopNavigation.tsx** - Desktop nav, category tree, links (lines 19-64, 94, 118, 129, 146, 155, 164)
20. **src/components/app/Footer.tsx** - Footer nav, link groups (lines 45-74, 322-341)
21. **src/components/app/mobile-bottom-nav.tsx** - Mobile bottom nav, tabs, cart drawer (lines 48-50)
22. **src/components/app/mobile-tabs.ts** - Mobile tabs config, match functions (lines 39-82)
23. **src/components/account/AccountSidebar.tsx** - Account sidebar nav, menu items (lines 6-12)
24. **src/components/admin/admin-sidebar.tsx** - Admin sidebar nav, menu items (lines 8-30)
25. **src/components/layout/header.tsx** - Header, RESERVED_SLUGS array (lines 13-35)
26. **src/components/app/mobile-tabs.ts** - Mobile tabs, RESERVED_SLUGS array (lines 2-17)
27. **src/components/app/Footer.tsx** - Footer nav, broken link `/sss` (line 61)
28. **package.json** - Next.js version, dependencies (next@16.1.1)

---

**Not:** Bu doküman, repo'nun mevcut durumuna göre oluşturulmuştur. Yeni route'lar eklendiğinde veya mevcut route'lar değiştirildiğinde bu doküman güncellenmelidir.

