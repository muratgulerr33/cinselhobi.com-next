# 10. Tasks Playbook

Bu doküman, Gemini → Cursor akışını "tek doğru görev formatı" ile standartlaştıran task yönetimi playbook'udur. Amaç: Görevlerin daha az hatayla, daha hızlı, daha deterministik uygulanmasını sağlamak.

**Last verified from package.json:** 2025-01-27  
**Proje:** cinselhobi-com-next  
**Next.js:** 16.1.1  
**React:** 19.2.3

**Evidence:** `package.json` (dependencies: next@16.1.1, react@19.2.3, react-dom@19.2.3)

---

## 1. Purpose

Bu playbook şunları standartlaştırır:

1. **Task Format Standardizasyonu:** Gemini'nin Cursor'a verdiği task format'ı tek doğru formata sabitler
2. **Uydurma Engelleme:** AI asistanların (Cursor/Gemini) uydurma endpoint/alan/component üretmesini engeller
3. **Hata Azaltma:** DoD checklist, risk planı, rollback stratejisi ile hata oranını düşürür
4. **Hız Artırma:** Standart format ile task intake → uygulama → review sürecini hızlandırır
5. **Deterministik Sonuçlar:** Her task'ta aynı kalite kapıları, aynı test süreçleri
6. **Small PR Yaklaşımı:** Büyük işleri parçalayarak AI-friendly PR boyutları sağlar
7. **Evidence-Based Development:** Her karar ve değişiklik mevcut dokümantasyon (01-09) ile kanıtlanır
8. **Rollback Güvenliği:** Riskli değişikliklerde rollback planı zorunlu

**Evidence:** `02.architecture-lock.md` (hard constraints), `08.api-contracts-frontend.md` (uydurma yasağı), `06.frontend-standards-2026.md` (DoD), `07.component-inventory.md` (component envanteri)

---

## 2. Operating Model (Gemini ↔ Cursor ↔ Murti)

### 2.1 Rol Dağılımı

**Murti (Kontrol/Test + Karar Verici):**
- Task request'i hazırlar (Task Request Intake Template ile)
- Uygulama sonrası manuel test yapar (smoke checklist)
- PR review yapar
- Karar verir: approve/reject/request changes

**Gemini (Beyin - Plan, Risk, Prompt):**
- Task request'i alır, analiz eder
- Mevcut dokümantasyonu (01-09) referans alır
- Plan oluşturur (Cursor Uygulama Paketi formatında)
- Risk ve rollback stratejisi belirler
- Assumption/Unknown'ları işaretler

**Cursor (Uygulayıcı - Dosya Değişikliği, Küçük PR):**
- Gemini'den gelen planı uygular
- Dosya değişikliklerini yapar
- DoD checklist'i kontrol eder
- Small PR oluşturur (5-7 dosya max)

**Evidence:** Plan requirements, `06.frontend-standards-2026.md` (Coding Standards > Small PR Rule)

### 2.2 Tek Kaynak Dokümanlar (01-09)

Tüm task'larda referans alınacak dokümanlar:

1. **01.project-brief.md** - Ürün/proje özeti, env/scripts, high-level evidence
2. **02.architecture-lock.md** - Hard constraints, yasaklar, izinli değişiklikler
3. **03.routes-and-navigation-map.md** - Route doğruluğu, navigasyon pattern'leri
4. **04.design-system.md** - Design tokens, component kontratları, exception'lar
5. **05.native-ux-rules.md** - Feedback, PDP bottom nav istisnası, kritik UX
6. **06.frontend-standards-2026.md** - DoD, kalite kapıları, kod standartları
7. **07.component-inventory.md** - Component envanteri, kullanım yerleri
8. **08.api-contracts-frontend.md** - Endpoint/contract uydurma yasağı
9. **09.data-fetching-cache-rules.md** - Fetch/caching karar ağacı

**Evidence:** `01.project-brief.md`, `02.architecture-lock.md`, `03.routes-and-navigation-map.md`, `04.design-system.md`, `05.native-ux-rules.md`, `06.frontend-standards-2026.md`, `07.component-inventory.md`, `08.api-contracts-frontend.md`, `09.data-fetching-cache-rules.md`

---

## 3. Rules of Engagement (Hard)

### 3.1 Uydurma Yasakları

1. **Uydurma endpoint/alan yok** - `08.api-contracts-frontend.md` tek kaynak, yeni endpoint/alan eklemek için doküman güncellenmeli (kanıt: `08.api-contracts-frontend.md` (Breaking-Change Rules): "Gemini/Cursor uydurma endpoint/alan yazamaz")
2. **Design token dışı core UI yok** - Core UI renk/spacing hardcode edilemez, `04.design-system.md` token'ları kullanılmalı (kanıt: `04.design-system.md` (Design System Constraints > Non-Negotiables > Color System): "Core UI colors CSS variables / design tokens üzerinden yönetilmelidir")
3. **Uydurma component yok** - Yeni component yazmadan önce `07.component-inventory.md` kontrol edilmeli (kanıt: `07.component-inventory.md` (Inventory Rules): "Yeni component yazmadan önce inventory kontrolü zorunlu")

**Evidence:** `08.api-contracts-frontend.md` (Breaking-Change Rules), `04.design-system.md` (Design System Constraints > Non-Negotiables > Color System), `07.component-inventory.md` (Inventory Rules)

### 3.2 Architecture Constraints

4. **RSC/Client boundary bozulmaz** - Server Component'ten Client Component'e prop geçişi serializable olmalı (kanıt: `02.architecture-lock.md` (Non-Negotiables > Rendering Model): "Server/Client boundary korunmalı")
5. **Route path değiştirmek yasak** - Mevcut route path'leri (`/urun/[slug]`, `/account/*`, `/checkout`) değiştirilemez (kanıt: `02.architecture-lock.md` (Non-Negotiables > Framework & Routing): "Route path'leri değiştirilemez")
6. **Provider hiyerarşisi değiştirilemez** - `layout.tsx` içindeki provider sırası sabit (kanıt: `02.architecture-lock.md` (Non-Negotiables > State Management): "Provider hiyerarşisi sabit")

**Evidence:** `02.architecture-lock.md` (Non-Negotiables > Framework & Routing, Rendering Model, State Management)

### 3.3 Development Rules

7. **Archive klasörü yok sayılır** - `archive/**` klasörü build/typecheck dışı, task'larda ignore edilir (kanıt: `02.architecture-lock.md` (Non-Negotiables > Build & Environment): "Archive klasörü exclude")
8. **Büyük değişiklik → task parçalama zorunlu** - L (multi-day) task'lar bölünmeli, önce plan PR, sonra uygulama PR'ları
9. **Önce mevcut component envanterine bak** - `07.component-inventory.md` kontrol edilmeli, duplicate component açılmamalı (kanıt: `07.component-inventory.md` (Inventory Rules): "Yeni component yazmadan önce inventory kontrolü zorunlu")
10. **Her task'ta DoD checklist zorunlu** - DoD bölümünde tanımlı checklist uygulanmalı (kanıt: `06.frontend-standards-2026.md` (Definition of Done))
11. **Her task'ta risk/rollback notu zorunlu** - Risk Management bölümünde tanımlı format kullanılmalı
12. **Varsayım gerekiyorsa `Assumption:` ile açıkça işaretle** - Unknown durumlar `Unknown:` ile işaretlenmeli

**Evidence:** `02.architecture-lock.md` (Non-Negotiables > Build & Environment), `07.component-inventory.md` (Inventory Rules), `06.frontend-standards-2026.md` (Definition of Done)

---

## 4. Task Levels (S/M/L)

### 4.1 Small (S) - ≤30 dk

**Kapsam:**
- 1-3 dosya değişikliği
- Lokal test + lint
- Tek bir feature/fix

**Örnekler:**
- UI tweak (button rengi, spacing)
- Bugfix (typo, küçük hata)
- Text değişikliği
- Küçük refactor (variable rename)

**DoD:**
- `npm run lint` hatasız
- `npm run build` başarılı
- Manuel smoke test (ilgili sayfa)

**Evidence:** `06.frontend-standards-2026.md` (Coding Standards > Small PR Rule)

### 4.2 Medium (M) - 0.5-1 gün

**Kapsam:**
- 4-10 dosya değişikliği
- Smoke akış testi
- Risk planı zorunlu

**Örnekler:**
- Yeni sayfa/route ekleme
- Component refactor
- Form validation iyileştirme
- API endpoint ekleme (doküman güncellemesi ile)

**DoD:**
- `npm run lint` hatasız
- `npm run build` başarılı
- Manuel smoke checklist (PLP → PDP → Cart → Checkout)
- Risk & rollback planı yazılı

**Evidence:** `06.frontend-standards-2026.md` (Definition of Done)

### 4.3 Large (L) - multi-day

**Kapsam:**
- 10+ dosya değişikliği
- Bölünmesi zorunlu
- Önce plan PR, sonra uygulama PR'ları

**Yaklaşım:**
1. **Plan PR:** Sadece plan dokümanı, değişiklik yok
2. **Uygulama PR'ları:** Plan onaylandıktan sonra, küçük PR'lara bölünmüş

**Örnekler:**
- Büyük refactor (state management değişikliği)
- Yeni feature (payment gateway entegrasyonu)
- Migration (Next.js version upgrade)

**Evidence:** Best practice (AI-friendly PR size)

---

## 5. Task Request Intake Template

Kullanıcının (Murti) bir task açarken göndereceği minimum bilgiler:

### 5.1 Zorunlu Alanlar

1. **Hedef route/sayfa:**
   - Örnek: `/urun/[slug]`, `/checkout`, `/account/addresses`
   - Route yoksa: "Yeni route: `/yeni-sayfa`"

2. **Amaç:**
   - Kısa açıklama (1-2 cümle)
   - Örnek: "Ürün detay sayfasında CTA butonunun rengini primary token'a göre güncelle"

3. **Kabul kriterleri:**
   - Test senaryoları
   - Örnek: "Button rengi `bg-primary` olmalı, dark mode'da doğru görünmeli"

4. **Tasarım referansı (varsa):**
   - Figma link, screenshot
   - Örnek: "Figma: https://figma.com/..."

5. **Yasaklar/korunacaklar:**
   - Değiştirilmemesi gerekenler
   - Örnek: "Route path değiştirilemez, mevcut component yapısı korunmalı"

6. **Test senaryosu:**
   - Manuel test adımları
   - Örnek: "1. `/urun/test-slug` sayfasına git, 2. Button rengini kontrol et"

**Evidence:** `03.routes-and-navigation-map.md` (route table), `04.design-system.md` (design tokens)

---

## 6. Cursor Uygulama Paketi (Standard Output)

Gemini'nin her cevapta Cursor'a vereceği standart format:

### 6.1 Teşhis (1-3 madde)

Mevcut durum analizi:
- Sorun nedir?
- Neden gerekli?
- Mevcut dokümantasyondan kanıt

**Örnek:**
```
Teşhis:
1. Ürün detay sayfasında CTA butonu hardcode renk kullanıyor, design token'a geçilmeli
2. 04.design-system.md'de primary token tanımlı (#ff2357), component'ler token kullanmalı
3. Mevcut kod: `bg-[#ff2357]` → Değişiklik: `bg-primary`
```

### 6.2 Plan (adım adım)

1. Dosya okuma (mevcut durum)
2. Değişiklik yapılacak yerler
3. Test adımları

**Örnek:**
```
Plan:
1. `src/components/product/product-view.tsx` dosyasını oku
2. `bg-[#ff2357]` class'ının geçtiği yerde `bg-primary` olarak değiştir
3. Dark mode'da test et (theme toggle ile)
```

### 6.3 Dosya Bazlı Değişiklik Listesi

Her dosya için:
- Dosya yolu
- Değişiklik türü (edit/create/delete)
- Değişiklik açıklaması (hangi bölüm/component/fonksiyon)

**Örnek:**
```
Dosya Değişiklikleri:
1. `src/components/product/product-view.tsx` (edit)
   - `bg-[#ff2357]` class'ının geçtiği yerde `bg-primary` olarak değiştir
   - Açıklama: Hardcode renk yerine design token kullan
```

### 6.4 DoD

DoD checklist'i (Definition of Done bölümünden):
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: [test senaryosu]

### 6.5 Risk & Rollback

Risk analizi ve rollback stratejisi:
- Risk: [risk açıklaması]
- Rollback: [rollback yöntemi]
- Örnek: "Risk: Düşük - Sadece CSS class değişikliği. Rollback: Git revert veya manuel class değişikliği"

### 6.6 Assumptions / Unknowns

Varsayımlar ve bilinmeyenler:
- `Assumption:` [varsayım]
- `Unknown:` [bilinmeyen]

**Örnek:**
```
Assumptions:
- Dark mode theme provider çalışıyor (04.design-system.md'de tanımlı)

Unknowns:
- Button'un diğer kullanım yerleri (07.component-inventory.md kontrol edilmeli)
```

**Evidence:** `06.frontend-standards-2026.md` (DoD), `02.architecture-lock.md` (risk management)

---

## 7. Definition of Done (DoD)

Bir task'ın "done" sayılması için zorunlu checklist:

### 7.1 Code Quality

1. **Lint:** `npm run lint` hatasız geçmeli (kanıt: `package.json` scripts: `"lint": "eslint"`)
2. **Build:** `npm run build` başarılı olmalı (kanıt: `package.json` scripts: `"build": "TZ=Europe/Istanbul next build"`)
3. **TypeScript:** Build sırasında TypeScript kontrol ediliyor, hata olmamalı (kanıt: `tsconfig.json` - strict mode)

**Evidence:** `package.json` (scripts), `tsconfig.json` (strict mode)

### 7.2 Functionality

4. **Server Component pattern:** Yeni sayfalar Server Component olmalı (gerekliyse Client Component)
5. **Error handling:** API route'lar ve Server Action'larda try-catch ile error handling
6. **Validation:** Form submit'ler ve API input'ları Zod ile validate edilmeli

**Evidence:** `02.architecture-lock.md` (Non-Negotiables > Rendering Model), `06.frontend-standards-2026.md` (Error Handling Standards)

### 7.3 Styling

7. **Design tokens kullanımı:** Tailwind class'ları design token'ları kullanmalı (`bg-primary`, `text-foreground`, vb.)
8. **Responsive design:** Mobile-first yaklaşım, breakpoint'ler doğru kullanılmalı

**Evidence:** `04.design-system.md` (Design Tokens), `05.native-ux-rules.md` (Mobile-First Patterns)

### 7.4 Manuel Test

9. **Smoke checklist:** Kritik akışlar manuel test edilmeli:
   - PLP (Product List Page) - kategori sayfası (`/[slug]`)
   - PDP (Product Detail Page) - ürün detay sayfası (`/urun/[slug]`)
   - Cart - sepet işlemleri (`/cart`)
   - Checkout - sipariş akışı (`/checkout`)
10. **Mobile test:** Mobile görünüm test edilmeli (`xl:hidden` breakpoint)
11. **Dark mode test:** Dark mode görünüm test edilmeli (theme toggle ile)

**Evidence:** `06.frontend-standards-2026.md` (Definition of Done), `03.routes-and-navigation-map.md` (Route Table)

---

## 8. Quality Gates

Her task'ta kontrol edilecek kalite kapıları:

### 8.1 Accessibility (A11y)

- **Focus ring:** Tüm interactive elementlerde `focus-visible:ring-2` pattern (kanıt: `04.design-system.md` (Accessibility Guidelines))
- **Keyboard navigation:** Dialog/Drawer'da keyboard navigation (Radix UI built-in)
- **ARIA labels:** Icon-only butonlarda `aria-label` (kanıt: `05.native-ux-rules.md` (Accessibility UX Rules))

**Evidence:** `04.design-system.md` (Accessibility Guidelines), `05.native-ux-rules.md` (Accessibility UX Rules)

### 8.2 UX

- **Loading/empty/error state zorunluluğu:** Her component'te loading, empty, error state'leri (kanıt: `05.native-ux-rules.md` (Loading / Empty / Error States))
- **Touch target min 44px:** Mobile'da interactive elementler `h-11` (44px) veya daha büyük (kanıt: `05.native-ux-rules.md` (Native UX Principles > Touch Target Sizes))
- **Safe area support:** iOS home indicator alanına uyum - `env(safe-area-inset-bottom)` (kanıt: `05.native-ux-rules.md` (Native UX Principles > Critical CTA Visibility))

**Evidence:** `05.native-ux-rules.md` (Native UX Principles > Touch Target Sizes, Loading / Empty / Error States)

### 8.3 Performance

- **Gereksiz `use client` yok:** Sadece gerekli durumlarda Client Component (kanıt: `06.frontend-standards-2026.md` (Component Standards > RSC vs Client Component Decision Tree))
- **Image optimization:** Next.js Image component kullanılmalı (kanıt: `06.frontend-standards-2026.md` (Performance Standards > Image Optimization))

**Evidence:** `06.frontend-standards-2026.md` (Component Standards > RSC vs Client Component Decision Tree, Performance Standards > Image Optimization)

### 8.4 Design

- **Token uyumu:** Core UI colors design token kullanmalı, hardcode renk yok (kanıt: `04.design-system.md` (Design System Constraints > Non-Negotiables > Color System))
- **Component inventory:** Yeni component yazmadan önce envanter kontrolü (kanıt: `07.component-inventory.md` (Inventory Rules))

**Evidence:** `04.design-system.md` (Design System Constraints > Non-Negotiables > Color System), `07.component-inventory.md` (Inventory Rules)

### 8.5 API

- **Contract uyumu:** API endpoint'leri `08.api-contracts-frontend.md`'de tanımlı olmalı (kanıt: `08.api-contracts-frontend.md` (Breaking-Change Rules))

**Evidence:** `08.api-contracts-frontend.md` (Breaking-Change Rules)

---

## 9. Risk Management & Rollback

### 9.1 Risk Seviyeleri

**Düşük Risk:**
- CSS class değişikliği
- Text değişikliği
- Küçük UI tweak
- **Rollback:** Git revert veya manuel değişiklik

**Orta Risk:**
- Component refactor
- Form validation değişikliği
- API endpoint ekleme
- **Rollback:** Git revert + smoke test

**Yüksek Risk:**
- Route path değişikliği
- State management değişikliği
- Database schema değişikliği
- **Rollback:** Git revert + migration rollback + smoke test

**Evidence:** `02.architecture-lock.md` (Non-Negotiables > Framework & Routing)

### 9.2 Rollback Stratejisi

**Git Revert:**
- En basit yöntem
- `git revert <commit-hash>`
- Smoke test sonrası merge

**Feature Flag (varsa):**
- Feature flag ile toggle
- Production'da test edilebilir
- Rollback: Flag'i kapat

**Snapshot/Tag:**
- Riskli değişikliklerden önce tag oluştur
- Rollback: Tag'a geri dön

**Evidence:** Best practice (git workflow)

### 9.3 "Breaks Routes" Riskine Karşı

- Route map kontrolü: `03.routes-and-navigation-map.md` referans alınmalı
- Route path değişikliği yasak: `02.architecture-lock.md` (Non-Negotiables > Framework & Routing)
- Dynamic route pattern korunmalı: `[slug]`, `[id]` pattern'leri değiştirilemez

**Evidence:** `03.routes-and-navigation-map.md`, `02.architecture-lock.md` (Non-Negotiables > Framework & Routing)

---

## 10. PR & Commit Rules

### 10.1 Commit Mesaj Standardı

**Format:** `type: kısa açıklama`

**Tipler:**
- `feat:` - Yeni feature
- `fix:` - Bug fix
- `docs:` - Dokümantasyon değişikliği
- `chore:` - Build/config değişikliği
- `refactor:` - Kod refactor (feature/fix değil)
- `style:` - Formatting (lint, prettier)

**Örnekler:**
- `feat: add address form drawer to checkout page`
- `fix: product card image alt text missing`
- `docs: update tasks playbook with examples`

**Evidence:** Conventional commits standard

### 10.2 PR Açıklaması

**Zorunlu Bölümler:**

1. **Değişen Dosyalar:**
   - Liste formatında
   - Örnek: `- src/components/product/product-view.tsx (edit)`

2. **Test Kanıtı:**
   - Screenshot (UI değişiklikleri için)
   - Test senaryosu
   - Örnek: "Test: `/urun/test-slug` sayfasında button rengi primary token kullanıyor"

3. **Risk & Rollback:**
   - Risk seviyesi
   - Rollback planı
   - Örnek: "Risk: Düşük - CSS class değişikliği. Rollback: Git revert"

4. **DoD Checklist:**
   - [x] `npm run lint` hatasız
   - [x] `npm run build` başarılı
   - [x] Manuel test: [test senaryosu]

**Evidence:** `06.frontend-standards-2026.md` (PR / Review Standards)

### 10.3 UI Değişimlerinde Görsel Şartı

- **Before/After screenshot:** UI değişikliklerinde zorunlu
- **Mobile & Desktop:** Her iki görünüm de gösterilmeli
- **Dark mode:** Dark mode görünümü de gösterilmeli (varsa)

**Evidence:** `06.frontend-standards-2026.md` (PR / Review Standards)

---

## 11. Anti-Patterns (Do/Don't)

### 11.1 DO

1. ✅ **Önce mevcut component envanterine bak** - `07.component-inventory.md` kontrol et
2. ✅ **Design token kullan** - Hardcode renk/spacing yok, `04.design-system.md` token'ları kullan
3. ✅ **API contract'a uy** - `08.api-contracts-frontend.md` tek kaynak, uydurma endpoint yok
4. ✅ **Small PR** - Her PR maksimum 5-7 dosya değişikliği
5. ✅ **DoD checklist** - Her task'ta DoD kontrolü zorunlu
6. ✅ **Assumption işaretle** - Varsayım gerekiyorsa `Assumption:` ile açıkça işaretle
7. ✅ **Route map kontrolü** - Route değişikliği yapmadan önce `03.routes-and-navigation-map.md` kontrol et

**Evidence:** `07.component-inventory.md` (Inventory Rules), `04.design-system.md` (Design System Constraints > Non-Negotiables > Color System), `08.api-contracts-frontend.md` (Breaking-Change Rules), `06.frontend-standards-2026.md` (Coding Standards > Small PR Rule)

### 11.2 DON'T

1. ❌ **Yeni component yazıp var olanı bypass etmek** - Önce envanter kontrolü
2. ❌ **Hardcode core UI renk/spacing** - Design token kullan
3. ❌ **Uydurma endpoint/field** - `08.api-contracts-frontend.md` tek kaynak
4. ❌ **Tek PR'da çok iş** - Small PR yaklaşımı, maksimum 5-7 dosya
5. ❌ **Test etmeden teslim** - DoD checklist zorunlu
6. ❌ **Assumption belirtmeden karar verme** - Unknown durumlar `Unknown:` ile işaretlenmeli
7. ❌ **Route path değiştirmek** - Mevcut route path'leri değiştirilemez (`02.architecture-lock.md`)

**Evidence:** `07.component-inventory.md` (Inventory Rules), `04.design-system.md` (Design System Constraints > Non-Negotiables > Color System), `08.api-contracts-frontend.md` (Breaking-Change Rules), `02.architecture-lock.md` (Non-Negotiables > Framework & Routing)

---

## 12. Task Templates

### 12.1 UI Tweak (Small)

**Amaç:** Küçük UI değişikliği (renk, spacing, text)

**Kapsam:**
- 1-3 dosya değişikliği
- Design token kullanımı
- Text değişikliği

**Dosyalar:**
- Component dosyası (edit)
- Test: İlgili sayfa

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: [sayfa] görünümü kontrol edildi
- [ ] Dark mode test edildi

**Risk:** Düşük - CSS/text değişikliği. Rollback: Git revert

**Evidence:** `04.design-system.md` (design tokens)

### 12.2 New Page/Route (Medium)

**Amaç:** Yeni sayfa/route ekleme

**Kapsam:**
- 4-10 dosya değişikliği
- Route dosyası (`src/app/[route]/page.tsx`)
- Component'ler (gerekirse)
- Loading/error state'ler

**Dosyalar:**
- `src/app/[route]/page.tsx` (create)
- Component dosyaları (create/edit)
- `03.routes-and-navigation-map.md` (edit - route ekle)

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: Yeni route çalışıyor
- [ ] Mobile test edildi
- [ ] Dark mode test edildi
- [ ] Route map güncellendi

**Risk:** Orta - Yeni route ekleme. Rollback: Git revert + route map güncelleme

**Evidence:** `03.routes-and-navigation-map.md` (route table), `02.architecture-lock.md` (App Router pattern)

### 12.3 Refactor (Medium)

**Amaç:** Component/function refactor

**Kapsam:**
- 4-10 dosya değişikliği
- Component yapısı değişikliği
- Function extraction/consolidation

**Dosyalar:**
- Component dosyaları (edit)
- Utility dosyaları (edit/create)
- Test: İlgili sayfalar

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel smoke test: PLP → PDP → Cart → Checkout
- [ ] Component inventory güncellendi (gerekirse)

**Risk:** Orta - Refactor riski. Rollback: Git revert + smoke test

**Evidence:** `07.component-inventory.md` (component envanteri)

### 12.4 Bugfix (Small)

**Amaç:** Bug düzeltme

**Kapsam:**
- 1-3 dosya değişikliği
- Hata düzeltme
- Test senaryosu

**Dosyalar:**
- Hatalı dosya (edit)
- Test: Hata senaryosu

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: Hata senaryosu test edildi, düzeltildi
- [ ] Regression test: İlgili sayfalar test edildi

**Risk:** Düşük - Bug fix. Rollback: Git revert

**Evidence:** `06.frontend-standards-2026.md` (error handling)

---

## 13. Examples (3-5 Örnek Task)

### 13.1 Örnek 1: PDP'de CTA Davranışı İyileştirme

**Task Request:**
- **Hedef route:** `/urun/[slug]`
- **Amaç:** Ürün detay sayfasında "Sepete Ekle" butonunun rengini hardcode `#ff2357` yerine design token `bg-primary` kullan
- **Kabul kriterleri:** Button rengi `bg-primary` olmalı, dark mode'da doğru görünmeli
- **Yasaklar:** Route path değiştirilemez, mevcut component yapısı korunmalı
- **Test senaryosu:** 1. `/urun/test-slug` sayfasına git, 2. Button rengini kontrol et, 3. Dark mode toggle ile test et

**Cursor Uygulama Paketi:**

**Teşhis:**
1. Ürün detay sayfasında CTA butonu hardcode renk kullanıyor, design token'a geçilmeli
2. `04.design-system.md`'de primary token tanımlı (`--primary: #ff2357`), component'ler token kullanmalı
3. Mevcut kod: `bg-[#ff2357]` → Değişiklik: `bg-primary`

**Plan:**
1. `src/components/product/product-view.tsx` dosyasını oku
2. `bg-[#ff2357]` class'ının geçtiği yerde (CTA button bölümünde) `bg-primary` olarak değiştir
3. Dark mode'da test et (theme toggle ile)

**Dosya Değişiklikleri:**
1. `src/components/product/product-view.tsx` (edit)
   - CTA button bölümünde `bg-[#ff2357]` class'ını `bg-primary` olarak değiştir
   - Açıklama: Hardcode renk yerine design token kullan

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: `/urun/test-slug` sayfasında button rengi `bg-primary` kullanıyor
- [ ] Dark mode test: Theme toggle ile dark mode'da button rengi doğru görünüyor

**Risk & Rollback:**
- Risk: Düşük - Sadece CSS class değişikliği
- Rollback: Git revert veya manuel class değişikliği

**Assumptions:**
- Dark mode theme provider çalışıyor (`04.design-system.md`'de tanımlı)
- Primary token dark mode'da da doğru çalışıyor

**Evidence:** `04.design-system.md` (Design Tokens > Colors), `src/components/product/product-view.tsx`

### 13.2 Örnek 2: LoadMoreGrid Filtre/Sort Bugfix

**Task Request:**
- **Hedef route:** `/[slug]` (kategori sayfası)
- **Amaç:** LoadMoreGrid component'inde filtre değiştiğinde cursor reset edilmiyor, ilk sayfadan başlamalı
- **Kabul kriterleri:** Filtre değiştiğinde ürün listesi baştan başlamalı, cursor reset edilmeli
- **Yasaklar:** API contract değiştirilemez (`08.api-contracts-frontend.md`)
- **Test senaryosu:** 1. `/[slug]` sayfasına git, 2. Filtre değiştir, 3. Ürün listesi baştan başlamalı

**Cursor Uygulama Paketi:**

**Teşhis:**
1. LoadMoreGrid component'inde filtre değiştiğinde cursor reset edilmiyor
2. `09.data-fetching-cache-rules.md`'de cursor pagination pattern tanımlı
3. Filtre değişikliğinde `cursor` state'i reset edilmeli

**Plan:**
1. `src/components/catalog/load-more-grid.tsx` dosyasını oku
2. Filtre değişikliğini detect et (`useEffect` ile)
3. Filtre değiştiğinde `cursor` state'ini `null` yap
4. `hasMore` state'ini `true` yap

**Dosya Değişiklikleri:**
1. `src/components/catalog/load-more-grid.tsx` (edit)
   - `useEffect` ekle: Filtre değişikliğinde cursor reset
   - Açıklama: Filtre değiştiğinde pagination baştan başlamalı

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: `/[slug]` sayfasında filtre değiştiğinde ürün listesi baştan başlıyor
- [ ] Regression test: Infinite scroll hala çalışıyor

**Risk & Rollback:**
- Risk: Orta - State management değişikliği
- Rollback: Git revert + smoke test

**Assumptions:**
- Filtre değişikliği `useEffect` ile detect edilebilir
- Cursor reset mekanizması mevcut API contract'a uygun

**Evidence:** `09.data-fetching-cache-rules.md` (cursor pagination), `src/components/catalog/load-more-grid.tsx`

### 13.3 Örnek 3: Signup Form Validation UX İyileştirme

**Task Request:**
- **Hedef route:** `/signup`
- **Amaç:** Signup form'unda validation error'ları inline gösterilmeli, sadece toast değil
- **Kabul kriterleri:** Form field'larında validation error'ları inline gösterilmeli, `text-destructive` rengi kullanılmalı
- **Yasaklar:** API contract değiştirilemez, mevcut Zod schema korunmalı
- **Test senaryosu:** 1. `/signup` sayfasına git, 2. Geçersiz email gir, 3. Submit et, 4. Inline error görünmeli

**Cursor Uygulama Paketi:**

**Teşhis:**
1. Signup form'unda validation error'ları sadece toast ile gösteriliyor, inline error yok
2. `06.frontend-standards-2026.md`'de form error display pattern tanımlı (inline error)
3. `src/components/auth/signup-form.tsx` dosyasında inline error display eklenmeli

**Plan:**
1. `src/components/auth/signup-form.tsx` dosyasını oku
2. React Hook Form `formState.errors` kullanarak inline error display ekle
3. Error mesajları `text-destructive bg-destructive/10` class'ları ile göster
4. Toast'u koru (kritik feedback için)

**Dosya Değişiklikleri:**
1. `src/components/auth/signup-form.tsx` (edit)
   - Inline error display ekle (form field'ların altında)
   - `text-destructive bg-destructive/10` class'ları kullan
   - Açıklama: Validation error'ları inline göster, toast'u koru

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: `/signup` sayfasında geçersiz form submit'inde inline error görünüyor
- [ ] A11y test: Error mesajları screen reader tarafından okunabilir

**Risk & Rollback:**
- Risk: Düşük - UI değişikliği, mevcut validation logic korunuyor
- Rollback: Git revert

**Assumptions:**
- React Hook Form `formState.errors` mevcut
- Destructive token tanımlı (`04.design-system.md`)

**Evidence:** `06.frontend-standards-2026.md` (Accessibility Standards > Form Error Messages), `04.design-system.md` (Design Tokens > Colors), `src/components/auth/signup-form.tsx`

### 13.4 Örnek 4: Checkout Empty Cart Handling İyileştirme

**Task Request:**
- **Hedef route:** `/checkout`
- **Amaç:** Checkout sayfasında sepet boşsa kullanıcıya daha iyi feedback verilmeli, empty state component'i eklenmeli
- **Kabul kriterleri:** Sepet boşsa empty state gösterilmeli, "Alışverişe Devam Et" butonu olmalı
- **Yasaklar:** Route path değiştirilemez, mevcut redirect logic korunmalı
- **Test senaryosu:** 1. Sepeti boşalt, 2. `/checkout` sayfasına git, 3. Empty state görünmeli

**Cursor Uygulama Paketi:**

**Teşhis:**
1. Checkout sayfasında sepet boşsa sadece redirect var, empty state yok
2. `05.native-ux-rules.md`'de empty state pattern tanımlı (Loading / Empty / Error States > Empty States)
3. Empty state component'i eklenmeli, redirect logic korunmalı

**Plan:**
1. `src/app/checkout/page.tsx` dosyasını oku
2. Sepet boş kontrolü yapılan yerde empty state component'i ekle
3. Empty state: "Sepetiniz boş" mesajı + "Alışverişe Devam Et" butonu (`/` route'una)
4. Redirect logic'i koru (server-side kontrol için)

**Dosya Değişiklikleri:**
1. `src/app/checkout/page.tsx` (edit)
   - Empty state component'i ekle (sepet boşsa)
   - "Alışverişe Devam Et" butonu ekle (`/` route'una)
   - Açıklama: Empty state UX iyileştirmesi

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: Sepet boşsa empty state görünüyor
- [ ] Manuel test: "Alışverişe Devam Et" butonu `/` route'una gidiyor
- [ ] Mobile test: Empty state mobile'da doğru görünüyor

**Risk & Rollback:**
- Risk: Düşük - UI değişikliği, mevcut logic korunuyor
- Rollback: Git revert

**Assumptions:**
- Sepet boş kontrolü mevcut (`useCart` hook)
- Empty state pattern `05.native-ux-rules.md`'de tanımlı

**Evidence:** `05.native-ux-rules.md` (Loading / Empty / Error States > Empty States), `src/app/checkout/page.tsx`

### 13.5 Örnek 5: ProductCard Image Alt Text Eksik

**Task Request:**
- **Hedef route:** Tüm sayfalar (ProductCard kullanılan yerler)
- **Amaç:** ProductCard component'inde image alt text eksik, a11y için eklenmeli
- **Kabul kriterleri:** Tüm ProductCard image'larında `alt` attribute olmalı, ürün adı kullanılmalı
- **Yasaklar:** Component yapısı değiştirilemez, sadece alt text eklenmeli
- **Test senaryosu:** 1. Herhangi bir sayfada ProductCard görünümünü kontrol et, 2. Image'da alt text olmalı

**Cursor Uygulama Paketi:**

**Teşhis:**
1. ProductCard component'inde image alt text eksik, a11y sorunu
2. `07.component-inventory.md`'de ProductCard a11y gap olarak işaretlenmiş (Component Health > Potential A11y Gaps)
3. Image component'ine `alt` prop'u eklenmeli, ürün adı kullanılmalı

**Plan:**
1. `src/components/product/product-card.tsx` dosyasını oku
2. Image component'ine `alt` prop'u ekle (`title` veya `name` prop'undan)
3. Tüm ProductCard kullanım yerlerini kontrol et (gerekirse)

**Dosya Değişiklikleri:**
1. `src/components/product/product-card.tsx` (edit)
   - Image component'ine `alt` prop'u ekle
   - Açıklama: A11y iyileştirmesi - image alt text

**DoD:**
- [ ] `npm run lint` hatasız
- [ ] `npm run build` başarılı
- [ ] Manuel test: ProductCard image'larında alt text görünüyor (dev tools ile kontrol)
- [ ] A11y test: Screen reader image alt text'i okuyor

**Risk & Rollback:**
- Risk: Düşük - Sadece alt text ekleme
- Rollback: Git revert

**Assumptions:**
- ProductCard'da `title` veya `name` prop'u mevcut
- Next.js Image component `alt` prop'unu destekliyor

**Evidence:** `07.component-inventory.md` (Component Health > Potential A11y Gaps), `src/components/product/product-card.tsx`

---

## 14. Evidence Index

En önemli referanslar:

1. **01.project-brief.md** - Ürün/proje özeti, env/scripts, high-level evidence
2. **02.architecture-lock.md** - Hard constraints, yasaklar, izinli değişiklikler, route path değiştirilemez kuralı
3. **03.routes-and-navigation-map.md** - Route table, navigasyon pattern'leri, dynamic routes
4. **04.design-system.md** - Design tokens, component kontratları, core UI colors token kuralı
5. **05.native-ux-rules.md** - UX kuralları, feedback pattern'leri, empty state pattern'leri
6. **06.frontend-standards-2026.md** - DoD, kalite kapıları, Small PR Rule, kod standartları
7. **07.component-inventory.md** - Component envanteri, yeni component yazmadan önce kontrol kuralı
8. **08.api-contracts-frontend.md** - API contract'ları, uydurma endpoint/alan yasağı
9. **09.data-fetching-cache-rules.md** - Fetch/caching karar ağacı, cursor pagination pattern
10. **package.json** - Dependencies, scripts (`npm run lint`, `npm run build`)
11. **tsconfig.json** - TypeScript strict mode, path aliases
12. **src/app/layout.tsx** - Provider hiyerarşisi, Server Component default
13. **src/components/product/product-view.tsx** - Product detail component, CTA button
14. **src/components/catalog/load-more-grid.tsx** - Infinite scroll, cursor pagination
15. **src/components/auth/signup-form.tsx** - Signup form, validation pattern
16. **src/app/checkout/page.tsx** - Checkout page, empty cart handling
17. **src/components/product/product-card.tsx** - Product card, image alt text

**Evidence:** Tüm yukarıdaki dosyalar codebase'de mevcut ve kanıt olarak kullanıldı

---

**Not:** Bu doküman, repo'nun mevcut durumuna göre oluşturulmuştur. Yeni task pattern'leri eklendiğinde veya mevcut pattern'ler değiştirildiğinde bu doküman güncellenmelidir.

